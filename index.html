---
layout: default
title: "SafeSpices"
stylesheet: /css/index.css
---

<table>
{% for row in site.data.spice_data %}
    {% if forloop.first %}
        <thead>
		<th>
		<div>
		<label for="filter-label">Label</label>
		<input type="text" name="filter-label" id="filter-label" oninput="filterLabel()" placeholder="filter...">
		</div>
		</th>
		<th>
		<div>
		<label for="filter-danger">Danger Level</label>
		<input type="text" min="0" max="4" name="filter-danger" id="filter-danger" oninput="filterDanger()" placeholder="filter...">
		</div>
		</th>
		<th>
		<div>
		<label for="filter-category">Category</label>
		<input type="text" name="filter-category" id="filter-category" oninput="filterCategory()" placeholder="filter...">
		</div>
		</th>
	</thead>
    {% endif %}
    <tr>
        <td>{{ row['Label'] }}</td>
	<td class="danger-{{row['Danger Level']}}">{{ row['Danger Level'] }}</td>
        <td>{{ row['Category'] }}</td>
    </tr>
{% endfor %}
</table>
<script>
function filterLabel(){
	filterTable("filter-label",0)
}
function filterDanger(){
	filterTable("filter-danger",1)
}
function filterCategory(){
	filterTable("filter-category",2)
}

function removeExistingHighlights() {
    document.querySelectorAll(".highlight").forEach(highlight => {
        const parent = highlight.parentNode;
        while (highlight.firstChild) {
            parent.insertBefore(highlight.firstChild, highlight);
        }
        parent.removeChild(highlight);
    });
}

function highlightText(td, filter) {
    const innerHTML = td.innerHTML;
    const index = innerHTML.toUpperCase().indexOf(filter);
    if (index >= 0) {
        td.innerHTML =
            innerHTML.substring(0, index) +
            "<span class='highlight'>" +
            innerHTML.substring(index, index + filter.length) +
            "</span>" +
            innerHTML.substring(index + filter.length);
    }
}

function filterAndHighlightRow(tr, td, filter) {
    if (td) {
        const txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr.style.display = "";
            filter && highlightText(td, filter);
        } else {
            tr.style.display = "none";
        }
    }
}

function filterTable(inpt_id, col) {
    const input = document.getElementById(inpt_id);
    const filter = input.value.toUpperCase();
    const table = document.querySelector("table");
    const tr = table.getElementsByTagName("tr");

    removeExistingHighlights();

    for (let i = 0; i < tr.length; i++) {
        const td = tr[i].getElementsByTagName("td")[col];
        filterAndHighlightRow(tr[i], td, filter);
    }
}
</script>

